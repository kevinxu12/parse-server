// Autogenerated Detail test, do not edit.

const originalEnvironment = process.env;
process.env.COPYSCAPE_USERNAME = "UNKNOWN";
process.env.COPYSCAPE_KEY = "REDACTED";
process.env.JUNE_KEY = "REDACTED";
process.env.MG_API_KEY = "REDACTED";
process.env.BUGSNAG_KEY = "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa";
process.env.NANGO = "REDACTED";
process.env.SCREENSHOT_ONE_ACCESS_KEY = "REDACTED";
process.env.SCREENSHOT_ONE_SECRET_KEY = "REDACTED";
process.env.__DETAIL_TEST_MODE = "true";

import { libraries, request, utils } from "@detail-dev/replay";
import pg from "pg";
import redis4 from "redis";
import crypto from "crypto";

jest.mock("pg");
jest.mock("redis", () => libraries.RedisInterceptor.createMock());
jest.mock("crypto", () => {
  const mCrypto = {
    ...jest.requireActual("crypto"),
    randomBytes: jest.fn(),
    randomUUID: jest.fn(),
  };
  return mCrypto;
});

describe("POST /parse/classes/GameScore", () => {
  let response: request.Response;
  // Set up pg fixtures.
  const pgCallsExpected = [
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "638b60a2fd3db60c",
      timestamp: 1718155434077000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          'CREATE TABLE IF NOT EXISTS "_SCHEMA" ( "className" varChar(120), "schema" jsonb, "isParseClass" bool, PRIMARY KEY ("className") )',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "c9790e0776ddbfc5",
      timestamp: 1718155434103000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "fa6b5f2ace006a23",
      timestamp: 1718155434114000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "816b5d9e75b9385e",
      timestamp: 1718155434115000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "8b4e7e5d21cd76b8",
      timestamp: 1718155434116000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "9f14ee8aafaf08ee",
      timestamp: 1718155434118000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "49264847dca13fe3",
      timestamp: 1718155434119000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "0494b2441858eb71",
      timestamp: 1718155434120000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "9fe2dc7a505dc0d0",
      timestamp: 1718155434122000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "231d1fd989f5b7fa",
      timestamp: 1718155434123000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          'CREATE TABLE IF NOT EXISTS "_Hooks" ("functionName" text,"className" text,"triggerName" text,"url" text)',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "db98a5a875fef328",
      timestamp: 1718155434139000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query: "begin",
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "f772012fa880b706",
      timestamp: 1718155434145000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query: "commit",
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "aeddb9ce0cd95c57",
      timestamp: 1718155434147000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "06a038096b451172",
      timestamp: 1718155434150000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          "SELECT column_name FROM information_schema.columns WHERE table_name = '_Hooks'",
        params: [],
      },
      output: {
        type: 1,
        value: [
          {
            column_name: "functionName",
          },
          {
            column_name: "className",
          },
          {
            column_name: "triggerName",
          },
          {
            column_name: "url",
          },
        ],
      },
      id: "374383b30dda3f33",
      timestamp: 1718155434153000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          'CREATE TABLE IF NOT EXISTS "_PushStatus" ("objectId" text,PRIMARY KEY ("objectId"),"createdAt" timestamp with time zone,"updatedAt" timestamp with time zone,"pushTime" text,"source" text,"query" text,"payload" text,"title" text,"expiry" double precision,"expiration_interval" double precision,"status" text,"numSent" double precision,"numFailed" double precision,"pushHash" text,"errorMessage" jsonb,"sentPerType" jsonb,"failedPerType" jsonb,"sentPerUTCOffset" jsonb,"failedPerUTCOffset" jsonb,"count" double precision,"_rperm" text[],"_wperm" text[])',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "59133565a666bf83",
      timestamp: 1718155434157000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          'CREATE TABLE IF NOT EXISTS "_Audience" ("objectId" text,PRIMARY KEY ("objectId"),"createdAt" timestamp with time zone,"updatedAt" timestamp with time zone,"name" text,"query" text,"lastUsed" timestamp with time zone,"timesUsed" double precision,"_rperm" text[],"_wperm" text[])',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "9d02f8c1d285cf8f",
      timestamp: 1718155434160000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          'CREATE TABLE IF NOT EXISTS "_JobStatus" ("objectId" text,PRIMARY KEY ("objectId"),"createdAt" timestamp with time zone,"updatedAt" timestamp with time zone,"jobName" text,"source" text,"status" text,"message" text,"params" jsonb,"finishedAt" timestamp with time zone,"_rperm" text[],"_wperm" text[])',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "6b3f68a85226d6cf",
      timestamp: 1718155434162000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          'CREATE TABLE IF NOT EXISTS "_JobSchedule" ("objectId" text,PRIMARY KEY ("objectId"),"createdAt" timestamp with time zone,"updatedAt" timestamp with time zone,"jobName" text,"description" text,"params" text,"startAfter" text,"daysOfWeek" jsonb,"timeOfDay" text,"lastRun" double precision,"repeatMinutes" double precision,"_rperm" text[],"_wperm" text[])',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "b40bf8d478298542",
      timestamp: 1718155434163000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          'CREATE TABLE IF NOT EXISTS "_Idempotency" ("objectId" text,PRIMARY KEY ("objectId"),"createdAt" timestamp with time zone,"updatedAt" timestamp with time zone,"reqId" text,"expire" timestamp with time zone,"_rperm" text[],"_wperm" text[])',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "57260f561005871f",
      timestamp: 1718155434165000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          'CREATE TABLE IF NOT EXISTS "_GraphQLConfig" ("objectId" text,PRIMARY KEY ("objectId"),"config" jsonb)',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "b9e9ae81d1d1e210",
      timestamp: 1718155434168000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query: "begin",
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "fcdf8ab28a6d2d49",
      timestamp: 1718155434170000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          'CREATE TABLE IF NOT EXISTS "_GlobalConfig" ("objectId" text,PRIMARY KEY ("objectId"),"params" jsonb,"masterKeyOnly" jsonb)',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "137f9e1d5586d844",
      timestamp: 1718155434173000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query: "begin",
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "f06936a81cdc3ef8",
      timestamp: 1718155434176000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query: "begin",
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "cbab76d86d31abea",
      timestamp: 1718155434179000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query: "begin",
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "4678e9d2d5996154",
      timestamp: 1718155434180000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query: "begin",
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "c35bef892b6b1cd8",
      timestamp: 1718155434183000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query: "commit",
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "2dc9ee41b006678b",
      timestamp: 1718155434189000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query: "begin",
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "0fad89f6335b7a83",
      timestamp: 1718155434193000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query: "commit",
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "148e2548f2acc9ee",
      timestamp: 1718155434197000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query: "commit",
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "425853551b841181",
      timestamp: 1718155434198000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query: "commit",
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "54ef6b893e37a9ae",
      timestamp: 1718155434198000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query: "commit",
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "aa434091306731c9",
      timestamp: 1718155434199000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query: "begin",
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "b4e1fa46fda34a27",
      timestamp: 1718155434202000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "bb72955ee117a2cc",
      timestamp: 1718155434204000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          "SELECT column_name FROM information_schema.columns WHERE table_name = '_PushStatus'",
        params: [],
      },
      output: {
        type: 1,
        value: [
          {
            column_name: "objectId",
          },
          {
            column_name: "createdAt",
          },
          {
            column_name: "updatedAt",
          },
          {
            column_name: "pushTime",
          },
          {
            column_name: "source",
          },
          {
            column_name: "query",
          },
          {
            column_name: "payload",
          },
          {
            column_name: "title",
          },
          {
            column_name: "expiry",
          },
          {
            column_name: "expiration_interval",
          },
          {
            column_name: "status",
          },
          {
            column_name: "numSent",
          },
          {
            column_name: "numFailed",
          },
          {
            column_name: "pushHash",
          },
          {
            column_name: "errorMessage",
          },
          {
            column_name: "sentPerType",
          },
          {
            column_name: "failedPerType",
          },
          {
            column_name: "sentPerUTCOffset",
          },
          {
            column_name: "failedPerUTCOffset",
          },
          {
            column_name: "count",
          },
          {
            column_name: "_rperm",
          },
          {
            column_name: "_wperm",
          },
        ],
      },
      id: "542695f66a1afaf0",
      timestamp: 1718155434205000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query: "commit",
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "1fa7b6d565eb082e",
      timestamp: 1718155434206000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "57ae6f39f1f8a28a",
      timestamp: 1718155434207000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          "SELECT column_name FROM information_schema.columns WHERE table_name = '_Audience'",
        params: [],
      },
      output: {
        type: 1,
        value: [
          {
            column_name: "objectId",
          },
          {
            column_name: "createdAt",
          },
          {
            column_name: "updatedAt",
          },
          {
            column_name: "name",
          },
          {
            column_name: "query",
          },
          {
            column_name: "lastUsed",
          },
          {
            column_name: "timesUsed",
          },
          {
            column_name: "_rperm",
          },
          {
            column_name: "_wperm",
          },
        ],
      },
      id: "5eb25b89c45233ac",
      timestamp: 1718155434209000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "7ffde97f69dfd0d3",
      timestamp: 1718155434214000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          "SELECT column_name FROM information_schema.columns WHERE table_name = '_JobStatus'",
        params: [],
      },
      output: {
        type: 1,
        value: [
          {
            column_name: "objectId",
          },
          {
            column_name: "createdAt",
          },
          {
            column_name: "updatedAt",
          },
          {
            column_name: "jobName",
          },
          {
            column_name: "source",
          },
          {
            column_name: "status",
          },
          {
            column_name: "message",
          },
          {
            column_name: "params",
          },
          {
            column_name: "finishedAt",
          },
          {
            column_name: "_rperm",
          },
          {
            column_name: "_wperm",
          },
        ],
      },
      id: "faee31e816e1b865",
      timestamp: 1718155434215000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "e84715099301e12a",
      timestamp: 1718155434220000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          "SELECT column_name FROM information_schema.columns WHERE table_name = '_JobSchedule'",
        params: [],
      },
      output: {
        type: 1,
        value: [
          {
            column_name: "objectId",
          },
          {
            column_name: "createdAt",
          },
          {
            column_name: "updatedAt",
          },
          {
            column_name: "jobName",
          },
          {
            column_name: "description",
          },
          {
            column_name: "params",
          },
          {
            column_name: "startAfter",
          },
          {
            column_name: "daysOfWeek",
          },
          {
            column_name: "timeOfDay",
          },
          {
            column_name: "lastRun",
          },
          {
            column_name: "repeatMinutes",
          },
          {
            column_name: "_rperm",
          },
          {
            column_name: "_wperm",
          },
        ],
      },
      id: "c83951d53fba16dd",
      timestamp: 1718155434223000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "ea3dab11c6b54d5b",
      timestamp: 1718155434226000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          "SELECT column_name FROM information_schema.columns WHERE table_name = '_Idempotency'",
        params: [],
      },
      output: {
        type: 1,
        value: [
          {
            column_name: "objectId",
          },
          {
            column_name: "createdAt",
          },
          {
            column_name: "updatedAt",
          },
          {
            column_name: "reqId",
          },
          {
            column_name: "expire",
          },
          {
            column_name: "_rperm",
          },
          {
            column_name: "_wperm",
          },
        ],
      },
      id: "aae58267a6f46492",
      timestamp: 1718155434229000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "06c7f43f71d88e4f",
      timestamp: 1718155434237000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          "SELECT column_name FROM information_schema.columns WHERE table_name = '_GlobalConfig'",
        params: [],
      },
      output: {
        type: 1,
        value: [
          {
            column_name: "objectId",
          },
          {
            column_name: "params",
          },
          {
            column_name: "masterKeyOnly",
          },
        ],
      },
      id: "091fa734b728e34f",
      timestamp: 1718155434240000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query: "commit",
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "62a04d46d6314efd",
      timestamp: 1718155434246000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "8dc08b90f229a036",
      timestamp: 1718155434257000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          "SELECT column_name FROM information_schema.columns WHERE table_name = '_GraphQLConfig'",
        params: [],
      },
      output: {
        type: 1,
        value: [
          {
            column_name: "objectId",
          },
          {
            column_name: "config",
          },
        ],
      },
      id: "27c90ca89a3fcddc",
      timestamp: 1718155434263000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "f08058e4504baa26",
      timestamp: 1718155434278000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query: "begin",
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "5b687a9204b4117d",
      timestamp: 1718155434279000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          'CREATE OR REPLACE FUNCTION json_object_set_key( "json" jsonb, key_to_set TEXT, value_to_set anyelement ) RETURNS jsonb LANGUAGE sql IMMUTABLE STRICT AS $function$ SELECT concat(\'{\', string_agg(to_json("key") || \':\' || "value", \',\'), \'}\')::jsonb FROM (SELECT * FROM jsonb_each("json") WHERE key <> key_to_set UNION ALL SELECT key_to_set, to_json("value_to_set")::jsonb) AS fields $function$;',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "e90e90e36e1f8fe4",
      timestamp: 1718155434280000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          'CREATE OR REPLACE FUNCTION array_add( "array" jsonb, "values" jsonb ) RETURNS jsonb LANGUAGE sql IMMUTABLE STRICT AS $function$ SELECT array_to_json(ARRAY(SELECT unnest(ARRAY(SELECT DISTINCT jsonb_array_elements("array")) || ARRAY(SELECT jsonb_array_elements("values")))))::jsonb; $function$;',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "e6876814868ffa70",
      timestamp: 1718155434282000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          'CREATE OR REPLACE FUNCTION array_add_unique( "array" jsonb, "values" jsonb ) RETURNS jsonb LANGUAGE sql IMMUTABLE STRICT AS $function$ SELECT array_to_json(ARRAY(SELECT DISTINCT unnest(ARRAY(SELECT DISTINCT jsonb_array_elements("array")) || ARRAY(SELECT DISTINCT jsonb_array_elements("values")))))::jsonb; $function$;',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "01494b38c77869d3",
      timestamp: 1718155434284000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          'CREATE OR REPLACE FUNCTION array_remove( "array" jsonb, "values" jsonb ) RETURNS jsonb LANGUAGE sql IMMUTABLE STRICT AS $function$ SELECT array_to_json(ARRAY(SELECT * FROM jsonb_array_elements("array") as elt WHERE elt NOT IN (SELECT * FROM (SELECT jsonb_array_elements("values")) AS sub)))::jsonb; $function$;',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "a7f5e2851c2c0868",
      timestamp: 1718155434285000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          'CREATE OR REPLACE FUNCTION array_contains_all( "array" jsonb, "values" jsonb ) RETURNS boolean LANGUAGE sql IMMUTABLE STRICT AS $function$ SELECT CASE WHEN 0 = jsonb_array_length("values") THEN true = false ELSE (SELECT RES.CNT = jsonb_array_length("values") FROM (SELECT COUNT(*) as CNT FROM jsonb_array_elements_text("array") as elt WHERE elt IN (SELECT jsonb_array_elements_text("values"))) as RES) END; $function$;',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "2d4b818248b1434b",
      timestamp: 1718155434286000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          'CREATE OR REPLACE FUNCTION array_contains_all_regex( "array" jsonb, "values" jsonb ) RETURNS boolean LANGUAGE sql IMMUTABLE STRICT AS $function$ SELECT CASE WHEN 0 = jsonb_array_length("values") THEN true = false ELSE (SELECT RES.CNT = jsonb_array_length("values") FROM (SELECT COUNT(*) as CNT FROM jsonb_array_elements_text("array") as elt WHERE elt LIKE ANY (SELECT jsonb_array_elements_text("values"))) as RES) END; $function$;',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "923cbbf100b6807a",
      timestamp: 1718155434288000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          'CREATE OR REPLACE FUNCTION array_contains( "array" jsonb, "values" jsonb ) RETURNS boolean LANGUAGE sql IMMUTABLE STRICT AS $function$ SELECT RES.CNT >= 1 FROM (SELECT COUNT(*) as CNT FROM jsonb_array_elements("array") as elt WHERE elt IN (SELECT jsonb_array_elements("values"))) as RES; $function$;',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "75bc4dc20c73ccc6",
      timestamp: 1718155434289000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query: "commit",
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "62c8b78d80cffae0",
      timestamp: 1718155434290000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "beff6eb30c7f3a6e",
      timestamp: 1718155434298000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query: 'SELECT * FROM "_SCHEMA"',
        params: [],
      },
      output: {
        type: 1,
        value: [
          {
            className: "_User",
            schema: {
              fields: {
                email: {
                  type: "String",
                },
                _rperm: {
                  type: "Array",
                  contents: {
                    type: "String",
                  },
                },
                _wperm: {
                  type: "Array",
                  contents: {
                    type: "String",
                  },
                },
                authData: {
                  type: "Object",
                },
                objectId: {
                  type: "String",
                },
                username: {
                  type: "String",
                },
                createdAt: {
                  type: "Date",
                },
                updatedAt: {
                  type: "Date",
                },
                emailVerified: {
                  type: "Boolean",
                },
                _hashed_password: {
                  type: "String",
                },
              },
              className: "_User",
            },
            isParseClass: true,
          },
          {
            className: "_Role",
            schema: {
              fields: {
                name: {
                  type: "String",
                },
                roles: {
                  type: "Relation",
                  targetClass: "_Role",
                },
                users: {
                  type: "Relation",
                  targetClass: "_User",
                },
                _rperm: {
                  type: "Array",
                  contents: {
                    type: "String",
                  },
                },
                _wperm: {
                  type: "Array",
                  contents: {
                    type: "String",
                  },
                },
                objectId: {
                  type: "String",
                },
                createdAt: {
                  type: "Date",
                },
                updatedAt: {
                  type: "Date",
                },
              },
              className: "_Role",
            },
            isParseClass: true,
          },
          {
            className: "GameScore",
            schema: {
              fields: {
                score: {
                  type: "Number",
                },
                _rperm: {
                  type: "Array",
                  contents: {
                    type: "String",
                  },
                },
                _wperm: {
                  type: "Array",
                  contents: {
                    type: "String",
                  },
                },
                objectId: {
                  type: "String",
                },
                cheatMode: {
                  type: "Boolean",
                },
                createdAt: {
                  type: "Date",
                },
                updatedAt: {
                  type: "Date",
                },
                playerName: {
                  type: "String",
                },
              },
              className: "GameScore",
            },
            isParseClass: true,
          },
        ],
      },
      id: "cd6c99e867f8b34f",
      timestamp: 1718155434301000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "c6d6ed011b42c42a",
      timestamp: 1718155434305000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          'CREATE UNIQUE INDEX IF NOT EXISTS "_User_unique_username" ON "_User"("username")',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "8e485c4648e243fd",
      timestamp: 1718155434306000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "5c26442d9bde5513",
      timestamp: 1718155434308000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          'CREATE INDEX IF NOT EXISTS "case_insensitive_username" ON "_User" (lower("username") varchar_pattern_ops)',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "e3336803e0a437f8",
      timestamp: 1718155434308000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "0ec9188de6635c89",
      timestamp: 1718155434310000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          'CREATE INDEX IF NOT EXISTS "case_insensitive_email" ON "_User" (lower("email") varchar_pattern_ops)',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "3cc68170b1a3ad28",
      timestamp: 1718155434311000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "0fa7cb404e2ca161",
      timestamp: 1718155434312000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          'CREATE UNIQUE INDEX IF NOT EXISTS "_User_unique_email" ON "_User"("email")',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "41bd288e5c150a7a",
      timestamp: 1718155434313000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "01b5eb82d5a8adc5",
      timestamp: 1718155434314000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          'CREATE UNIQUE INDEX IF NOT EXISTS "_Role_unique_name" ON "_Role"("name")',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "df4ec1d65ce46f31",
      timestamp: 1718155434314000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "edb637974a99d498",
      timestamp: 1718155434314000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          'CREATE UNIQUE INDEX IF NOT EXISTS "_Idempotency_unique_reqId" ON "_Idempotency"("reqId")',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "95573f897f9a3ec1",
      timestamp: 1718155434315000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "e6f0a6db27ac2219",
      timestamp: 1718155434316000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query:
          "CREATE OR REPLACE FUNCTION idempotency_delete_expired_records() RETURNS void LANGUAGE plpgsql AS $$ BEGIN DELETE FROM \"_Idempotency\" WHERE expire < NOW() - INTERVAL '300 seconds'; END; $$;",
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "62d5b7d428b1df76",
      timestamp: 1718155434317000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "3b911d5067d5736d",
      timestamp: 1718155434320000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query: 'CREATE INDEX IF NOT EXISTS "ttl" ON "_Idempotency" ("expire")',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "2002b8afbdf3b485",
      timestamp: 1718155434320000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "7938cba543a5824f",
      timestamp: 1718155434323000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        query: 'SELECT * FROM "_Hooks"',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "b611c524724c45ea",
      timestamp: 1718155434324000,
      startup: true,
    },
    {
      library: "pg",
      input: {
        connectionString: "*",
        isViaPool: true,
      },
      output: {
        type: 2,
        value: [],
      },
      id: "dfeb11fde5249fcb",
      timestamp: 1718155436054000,
      startup: false,
    },
    {
      library: "pg",
      input: {
        query:
          'INSERT INTO "GameScore" ("score","playerName","cheatMode","updatedAt","createdAt","objectId") VALUES (1337,\'Sean Plott\',false,\'2024-06-12T01:23:56.050Z\',\'2024-06-12T01:23:56.050Z\',\'7Veh0xgCAt\')',
        params: [],
      },
      output: {
        type: 1,
        value: [],
      },
      id: "527dd66d73530c11",
      timestamp: 1718155436056000,
      startup: false,
    },
  ];
  let pgInterceptor: libraries.PgInterceptor;

  let redisInterceptor: libraries.RedisInterceptor;

  let httpInterceptor: libraries.HttpInterceptor;

  // Set up crypto fixtures.
  const cryptoCallsExpected = [
    {
      library: "crypto",
      input: {
        functionName: "randomUUID",
        args: [],
      },
      output: "9b4ed77f-2d51-4c8d-8963-05842dae97b0",
      id: "f1d464cf50033844",
      timestamp: 1718155434070000,
      startup: true,
    },
    {
      library: "crypto",
      input: {
        functionName: "randomBytes",
        args: [10],
      },
      output: {
        type: "Buffer",
        data: [183, 83, 30, 219, 114, 49, 218, 126, 62, 169],
      },
      id: "fe420d47df730bea",
      timestamp: 1718155436052000,
      startup: false,
    },
  ];
  let cryptoInterceptor: libraries.CryptoInterceptor;

  const OriginalDate = Date;
  // Set up date fixtures.
  const dateCallsExpected = [
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.031Z",
      id: "408af07c80cec6fd",
      timestamp: 1718155434031000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434034",
      id: "8cc8982b924a7eee",
      timestamp: 1718155434034000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434041",
      id: "f1aa13846d24de77",
      timestamp: 1718155434041000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434047",
      id: "219539cab99442ab",
      timestamp: 1718155434046000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434074",
      id: "37331dee143ee1c7",
      timestamp: 1718155434074000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434076",
      id: "f1caf031922b166e",
      timestamp: 1718155434076000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.097Z",
      id: "b3c5234b97586775",
      timestamp: 1718155434096000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434100",
      id: "7563ab9008ee14ca",
      timestamp: 1718155434099000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.135Z",
      id: "43934fada50fcb01",
      timestamp: 1718155434134000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.138Z",
      id: "eb0df0acb28d9ad9",
      timestamp: 1718155434138000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434139",
      id: "939b9a35bc11fdab",
      timestamp: 1718155434139000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.144Z",
      id: "70f214b811eb7557",
      timestamp: 1718155434144000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434144",
      id: "fc9c9b040b39ea86",
      timestamp: 1718155434144000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434146",
      id: "af6fc96025f1d2bd",
      timestamp: 1718155434146000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.149Z",
      id: "d9de954ef79f36ea",
      timestamp: 1718155434149000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.149Z",
      id: "7651320595539ee3",
      timestamp: 1718155434149000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.151Z",
      id: "9a73099397afdb5f",
      timestamp: 1718155434151000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.151Z",
      id: "6a417b8649e1d6c4",
      timestamp: 1718155434151000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434153",
      id: "4472c5543099535f",
      timestamp: 1718155434153000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.155Z",
      id: "91c2aa66a0d8890b",
      timestamp: 1718155434155000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.155Z",
      id: "a6206196667535e5",
      timestamp: 1718155434155000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434156",
      id: "648904935e331169",
      timestamp: 1718155434156000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.158Z",
      id: "9df9d9727c2fc1e4",
      timestamp: 1718155434158000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.158Z",
      id: "6864d565cb9d41f5",
      timestamp: 1718155434158000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434159",
      id: "0442989524d7a8bc",
      timestamp: 1718155434159000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.161Z",
      id: "3be5eba0a666dce1",
      timestamp: 1718155434161000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.162Z",
      id: "1dc56e0a0b25a8ea",
      timestamp: 1718155434162000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434162",
      id: "90e567803a119f50",
      timestamp: 1718155434162000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.163Z",
      id: "a3c4a488448c3681",
      timestamp: 1718155434163000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.163Z",
      id: "50a52f59680e7bda",
      timestamp: 1718155434163000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434163",
      id: "9d774343160b369d",
      timestamp: 1718155434163000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.164Z",
      id: "71938a4ffe60ed6c",
      timestamp: 1718155434164000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.164Z",
      id: "acf8036669b8fc1c",
      timestamp: 1718155434164000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434164",
      id: "efda257178667441",
      timestamp: 1718155434164000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.166Z",
      id: "eddb396de2da78a0",
      timestamp: 1718155434166000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.167Z",
      id: "917ae4b9a5910e13",
      timestamp: 1718155434167000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434167",
      id: "7b9fd4416abc07ee",
      timestamp: 1718155434167000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.170Z",
      id: "0d9bc92adb43fe49",
      timestamp: 1718155434170000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434170",
      id: "0052810f1b6a3544",
      timestamp: 1718155434170000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.172Z",
      id: "d627bf1153633677",
      timestamp: 1718155434172000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.172Z",
      id: "d4537ff80f8ebc12",
      timestamp: 1718155434172000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434173",
      id: "86df0d3cd8037554",
      timestamp: 1718155434173000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.175Z",
      id: "612b7d12b484c6f0",
      timestamp: 1718155434175000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434176",
      id: "fe5ecf4aa28d96ac",
      timestamp: 1718155434176000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.179Z",
      id: "f9118925ea41d729",
      timestamp: 1718155434179000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434179",
      id: "e0dcd87563544838",
      timestamp: 1718155434179000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.180Z",
      id: "ce9ef24039b19027",
      timestamp: 1718155434180000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434180",
      id: "3c52cee3d791c6ac",
      timestamp: 1718155434180000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.183Z",
      id: "a2e46e08aca35603",
      timestamp: 1718155434183000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434183",
      id: "00f169929595ca69",
      timestamp: 1718155434183000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.186Z",
      id: "f88f0880bc767a49",
      timestamp: 1718155434186000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434188",
      id: "ffbaa54efa7984a8",
      timestamp: 1718155434188000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.192Z",
      id: "6b7dede07437fe2d",
      timestamp: 1718155434192000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434193",
      id: "9d6906cd5d0b54ef",
      timestamp: 1718155434193000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434196",
      id: "9fe8e4b4e21fa407",
      timestamp: 1718155434196000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434198",
      id: "9b85e514d2629a50",
      timestamp: 1718155434198000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434198",
      id: "95fa9f9ac07aacd0",
      timestamp: 1718155434198000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434199",
      id: "bd6f03ad1cae523d",
      timestamp: 1718155434199000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.201Z",
      id: "7047e9195a114edc",
      timestamp: 1718155434201000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434202",
      id: "60e74216ba705956",
      timestamp: 1718155434202000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.204Z",
      id: "3b1f8c0b58d2ccfb",
      timestamp: 1718155434204000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.204Z",
      id: "4c1939a7e856cedd",
      timestamp: 1718155434204000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.204Z",
      id: "612efb2a9afe29ea",
      timestamp: 1718155434204000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.205Z",
      id: "1fe720b48ba8e052",
      timestamp: 1718155434205000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434205",
      id: "4b3f61838aa682e3",
      timestamp: 1718155434205000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434206",
      id: "48c79252dcaab80e",
      timestamp: 1718155434206000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.206Z",
      id: "7be4e80f5e5f43c9",
      timestamp: 1718155434206000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.206Z",
      id: "a134cc92474d9107",
      timestamp: 1718155434206000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.208Z",
      id: "74bdf1350f079314",
      timestamp: 1718155434208000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.208Z",
      id: "4949f91703abf64c",
      timestamp: 1718155434208000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434209",
      id: "5eed2e917adafec5",
      timestamp: 1718155434209000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.213Z",
      id: "af9d234263def8be",
      timestamp: 1718155434213000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.213Z",
      id: "e5f7f84c1af4eafc",
      timestamp: 1718155434213000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.214Z",
      id: "94e9d512d5c5b161",
      timestamp: 1718155434214000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.214Z",
      id: "3ad0615a40b078e2",
      timestamp: 1718155434214000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434215",
      id: "73c8783723ba435e",
      timestamp: 1718155434215000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.219Z",
      id: "81bda1db99fe2251",
      timestamp: 1718155434219000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.219Z",
      id: "576e9693ea307ea0",
      timestamp: 1718155434219000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.221Z",
      id: "d6e6a81921e704bb",
      timestamp: 1718155434221000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.222Z",
      id: "661f5c6624f1974e",
      timestamp: 1718155434222000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434223",
      id: "74d0bd9b1fc7c149",
      timestamp: 1718155434223000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.225Z",
      id: "fb49cc1a5dff5505",
      timestamp: 1718155434225000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.225Z",
      id: "6602988af7ee1eab",
      timestamp: 1718155434225000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.227Z",
      id: "615a1535d9aed3cb",
      timestamp: 1718155434227000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.228Z",
      id: "ade85ed0a0e3aee8",
      timestamp: 1718155434228000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434229",
      id: "d3bb7b712f30b6bd",
      timestamp: 1718155434229000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.234Z",
      id: "f862242c2d05eaeb",
      timestamp: 1718155434234000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.235Z",
      id: "3cdac7ced4307a23",
      timestamp: 1718155434235000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.235Z",
      id: "190201d022fe7eb0",
      timestamp: 1718155434235000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.238Z",
      id: "d288818bd84a1f5e",
      timestamp: 1718155434238000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.239Z",
      id: "fdf386d2b13c72e4",
      timestamp: 1718155434238000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434239",
      id: "50f85409e7eb5545",
      timestamp: 1718155434239000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.243Z",
      id: "d440b3da57c7b270",
      timestamp: 1718155434243000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.245Z",
      id: "c1d95f080debac61",
      timestamp: 1718155434245000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.245Z",
      id: "32c7098a8e9e7a0b",
      timestamp: 1718155434245000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434246",
      id: "2dcb9d1f8947db19",
      timestamp: 1718155434246000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.250Z",
      id: "596d9b1bc50a4a03",
      timestamp: 1718155434250000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.253Z",
      id: "45b9b44afa58936c",
      timestamp: 1718155434253000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.253Z",
      id: "7acd52c277b60934",
      timestamp: 1718155434253000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.261Z",
      id: "94fd150982426861",
      timestamp: 1718155434261000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.262Z",
      id: "0b5bd0e1abc5adff",
      timestamp: 1718155434262000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434263",
      id: "41469333029cd013",
      timestamp: 1718155434263000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.266Z",
      id: "a906df4686e6879d",
      timestamp: 1718155434266000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.277Z",
      id: "9b25d59e2ef53b81",
      timestamp: 1718155434277000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.278Z",
      id: "af0c9bd1ff3c0b85",
      timestamp: 1718155434278000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.278Z",
      id: "9f270ed9abf1ff47",
      timestamp: 1718155434278000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434279",
      id: "c8dd46c477e8d446",
      timestamp: 1718155434279000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434280",
      id: "9b075fe2d438f5ef",
      timestamp: 1718155434280000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434282",
      id: "0559cde389c1acc5",
      timestamp: 1718155434282000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434284",
      id: "ba02987668038ced",
      timestamp: 1718155434284000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434285",
      id: "af4af70fd3240689",
      timestamp: 1718155434285000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434286",
      id: "698299a23c20b5cb",
      timestamp: 1718155434286000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434288",
      id: "5a0d5dd1a12b29d4",
      timestamp: 1718155434288000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434289",
      id: "05b9f8554180f3c2",
      timestamp: 1718155434289000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434290",
      id: "ab54daa0a31629bb",
      timestamp: 1718155434290000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.295Z",
      id: "9f8d88961d0a538a",
      timestamp: 1718155434295000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.299Z",
      id: "7968d178852c6f72",
      timestamp: 1718155434299000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.299Z",
      id: "c6982280a76ff541",
      timestamp: 1718155434299000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434300",
      id: "df2b5d003a2ad4d7",
      timestamp: 1718155434300000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.303Z",
      id: "2d7a822e679fd1af",
      timestamp: 1718155434303000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.306Z",
      id: "a596abe891093a1d",
      timestamp: 1718155434306000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434306",
      id: "105a1ab50a85bb76",
      timestamp: 1718155434306000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.308Z",
      id: "b4f513dcbad6580b",
      timestamp: 1718155434308000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434308",
      id: "b5f6972a9de4d4ea",
      timestamp: 1718155434308000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.310Z",
      id: "c0f73af5187e7abc",
      timestamp: 1718155434310000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434310",
      id: "0dbc1461a79eb7d3",
      timestamp: 1718155434310000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.312Z",
      id: "5362770348135eac",
      timestamp: 1718155434312000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434313",
      id: "da3b0f0766d9b92c",
      timestamp: 1718155434313000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.314Z",
      id: "3728c6ec4683e99e",
      timestamp: 1718155434314000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434314",
      id: "4e40fc1b97c7957a",
      timestamp: 1718155434314000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.315Z",
      id: "e13928f4a8a2f166",
      timestamp: 1718155434315000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434315",
      id: "2b3194c50b7454af",
      timestamp: 1718155434315000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.316Z",
      id: "befd702b8f3c3783",
      timestamp: 1718155434316000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434317",
      id: "37f09404c08800eb",
      timestamp: 1718155434317000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.320Z",
      id: "daa75c7b7611d179",
      timestamp: 1718155434320000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434320",
      id: "f57f6c4e69b8b116",
      timestamp: 1718155434320000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:54.324Z",
      id: "fb3330a164069bf8",
      timestamp: 1718155434324000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434324",
      id: "e420ca6c2b0d5f11",
      timestamp: 1718155434324000,
      startup: true,
    },
    {
      library: "date",
      input: "now",
      output: "1718155434325",
      id: "8c602ad04d0cb3aa",
      timestamp: 1718155434325000,
      startup: true,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:56.047Z",
      id: "55c126461c1a7df9",
      timestamp: 1718155436047000,
      startup: false,
    },
    {
      library: "date",
      input: "now",
      output: "1718155436048",
      id: "adf0bfc833b42104",
      timestamp: 1718155436048000,
      startup: false,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:56.050Z",
      id: "89c7962fd420a8dc",
      timestamp: 1718155436050000,
      startup: false,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:56.055Z",
      id: "57a598da8af2b270",
      timestamp: 1718155436055000,
      startup: false,
    },
    {
      library: "date",
      input: "now",
      output: "1718155436056",
      id: "4d2b7d20299f3ddc",
      timestamp: 1718155436056000,
      startup: false,
    },
    {
      library: "date",
      input: "now",
      output: "1718155436060",
      id: "31a868211d1320bf",
      timestamp: 1718155436060000,
      startup: false,
    },
    {
      library: "date",
      input: "Date.new",
      output: "2024-06-12T01:23:56.061Z",
      id: "57848cf619726aa7",
      timestamp: 1718155436061000,
      startup: false,
    },
    {
      library: "date",
      input: "now",
      output: "1718155436062",
      id: "22c7f6d8199a0044",
      timestamp: 1718155436062000,
      startup: false,
    },
  ];
  let dateInterceptor: libraries.DateInterceptor;

  const EXPECTED_BODY =
    '{"objectId":"7Veh0xgCAt","createdAt":"2024-06-12T01:23:56.050Z"}';
  const EXPECTED_RESPONSE_HEADER = {
    "x-powered-by": "Express",
    "access-control-allow-methods": "GET,PUT,POST,DELETE,OPTIONS",
    "access-control-allow-headers":
      "X-Parse-Master-Key, X-Parse-REST-API-Key, X-Parse-Javascript-Key, X-Parse-Application-Id, X-Parse-Client-Version, X-Parse-Session-Token, X-Requested-With, X-Parse-Revocable-Session, X-Parse-Request-Id, Content-Type, Pragma, Cache-Control",
    "access-control-expose-headers":
      "X-Parse-Job-Status-Id, X-Parse-Push-Status-Id",
    location: "http://localhost:1337/parse/classes/GameScore/7Veh0xgCAt",
    "content-type": "application/json; charset=utf-8",
  };

  afterEach(async () => {
    global.Date = OriginalDate;
    jest.restoreAllMocks();
    process.env = originalEnvironment;

    // Emit test results.
    utils.serializeTestResults("generated/test_results/0.json", {
      traceId: "bdb89e9e2e23b339c39b6ca0b55e3cb1",
      testFile: __filename.split("/").pop() as string,
      request: {
        pathKey: "/parse/classes/:className",
        route: "/parse/classes/GameScore",
        method: "POST",
      },
      response: {
        expected: {
          status: 201,
          body: EXPECTED_BODY,
          header: EXPECTED_RESPONSE_HEADER,
        },
        observed: {
          status: response.status,
          body:
            (response.headers && response.headers["content-length"] == 0) ||
            (!response.text &&
              response.body &&
              !Object.keys(response.body).length)
              ? undefined
              : response.text || JSON.stringify(response.body),
          header: libraries.canonicalizeResHeaders(response.header),
        },
      },
      expectedCalls: [
        ...pgCallsExpected,
        ...cryptoCallsExpected,
        ...dateCallsExpected,
      ],
      observedCalls: [
        ...pgInterceptor.getObservedCalls(),
        ...redisInterceptor.getObservedCalls(),
        ...httpInterceptor.getObservedCalls(),
        ...cryptoInterceptor.getObservedCalls(),
        ...dateInterceptor.getObservedCalls(),
      ],
    });
  });

  it("should run as expected with example data", async () => {
    pgInterceptor = new libraries.PgInterceptor(pg);
    pgInterceptor.expectCalls(pgCallsExpected);

    redisInterceptor = new libraries.RedisInterceptor(redis4);
    redisInterceptor.expectCalls([]);

    // @ts-expect-error we manage http mocking globally, so that we can reuse a
    // global polly server. We pass in hooks to manage the global state here.
    httpInterceptor = new libraries.HttpInterceptor(global.__HTTP_CALL_HOOKS__);
    httpInterceptor.expectCalls([]);

    cryptoInterceptor = new libraries.CryptoInterceptor(crypto);
    cryptoInterceptor.expectCalls(cryptoCallsExpected);

    dateInterceptor = new libraries.DateInterceptor();
    dateInterceptor.expectCalls(dateCallsExpected);

    // Import the app.
    let { getApp } = await import("../config");
    const app = await getApp();

    // Make the request.
    response = await request(app)
      .post("/parse/classes/GameScore")
      .set("host", "localhost:1337")
      .set("user-agent", "curl/8.4.0")
      .set("accept", "*/*")
      .set("x-parse-application-id", "APP_ID")
      .set("x-parse-master-key", "MASTER_KEY")
      .set("content-type", "application/json")
      .set("x-detail-originator", "detail")
      .send({ score: 1337, playerName: "Sean Plott", cheatMode: false });
  });
});
